<div class="modal fade" id="modalRegistroUsrs" tabindex="-1" aria-labelledby="modalRegistroLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="modalRegistroLabel">Nuevo usuario</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form action="/registro_usuariosModal" method="post" onsubmit="return validarFormulario()">
                        
                    <div class="mb-3">
                        <label for="registarnombre" class="form-label">Nombre</label>
                        <input type="text" class="form-control" id="registarnombre" name="registarnombre">
                        <div class="invalid-feedback" id="nombreError"></div>
                    </div>
                    <div class="mb-3">
                        <label for="registrarapellido" class="form-label">Apellidos</label>
                        <input type="text" class="form-control" id="registrarapellido" name="registrarapellido">
                        <div class="invalid-feedback" id="apellidoError"></div>
                    </div>
                    <div class="mb-3">
                        <label for="registrargenero" class="form-label">Género</label>
                        <select class="form-control" name="registrargenero" id="registrargenero">Selecciona un género
                            <option value="">Selecciona un género</option>
                            <option value="Masculino">Masculino</option>
                            <option value="Femenino">Femenino</option>
                            
                        </select>
                        <div class="invalid-feedback" id="generoError"></div>
                    </div>
                    <div class="mb-3">
                        <label for="registrarprivilegio" class="form-label">Privilegio</label>
                        <select class="form-control" name="registrarprivilegio" id="registrarprivilegio">Selecciona un privilegio
                            <option value="">Selecciona un privilegio</option>
                            <option value="Administrador">Administrador</option>
                            <option value="Sub-Administrador">Sub-Administrador</option>
                            
                        </select>
                        <div class="invalid-feedback" id="privilegioError"></div>
                    </div>
                    <div class="mb-3">
                        <label for="registrarusuario" class="form-label">Usuario</label>
                        <input type="text" class="form-control" id="registrarusuario" name="registrarusuario">
                        <div class="invalid-feedback" id="usuarioError"></div>
                    </div>
                    <div class="mb-3">
                        <label for="registrarcontraseña" class="form-label">Contraseña</label>
                        <input type="password" class="form-control" id="registrarcontraseña" name="registrarcontraseña">
                        <div class="invalid-feedback" id="contrasenaError"></div>
                    </div>
                    <div class="mb-3">
                        <label for="registrarcontraseñaC" class="form-label">Confirmar contraseña</label>
                        <input type="password" class="form-control" id="registrarcontraseñaC" name="registrarcontraseñaC">
                        <div class="invalid-feedback" id="confirmarError"></div><br>
                    
                    <div class="modal-footer">
                        <a type="button" class="btn btn-secondary" id="cerrar" href="" >Cancelar</a>
                        <button type="submit" class="btn btn-danger">Registrar</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
  </div>
  

  <script>
    function validarFormulario() {
        var isValid = true;
    
        // Validar el nombre con expresión regular (permitiendo letras, espacios y guiones)
        var nombre = document.getElementById('registarnombre').value;
        var nombreError = document.getElementById('nombreError');
        var nombreRegex = /^[A-ZÁÉÍÓÚÜÑ][a-záéíóúüñ]+(?:\s+[A-ZÁÉÍÓÚÜÑ][a-záéíóúüñ]+)?(?:\s+[A-ZÁÉÍÓÚÜÑ][a-záéíóúüñ]+)?$/;
        var expresionnom = /^[A-ZÁÉÍÓÚÜÑ][a-záéíóúüñ]+(?:\s[A-ZÁÉÍÓÚÜÑ][a-záéíóúüñ]+)?$/;


         if (!expresionnom.test(nombre)) {
            nombreError.textContent = 'Por favor, ingresa un nombre válido. Sin multiples espacios.';
            nombreError.style.display = 'block';
            isValid = false;
        } else {
            nombreError.textContent = '';
            nombreError.style.display = 'none';
        }


        var apellidos = document.getElementById('registrarapellido').value;
        var apellidosError = document.getElementById('apellidoError');
        var expresionap = /^[A-ZÁÉÍÓÚÜÑ][a-záéíóúüñ]+(?:\s[A-ZÁÉÍÓÚÜÑ][a-záéíóúüñ]+)?$/;


         if (!expresionap.test(apellidos)) {
            apellidosError.textContent = 'Por favor, ingresa tus apellidos. Acepta dos apellidos iniciendo con mayuculas las dos.';
            apellidosError.style.display = 'block';
            isValid = false;
        } else {
            apellidosError.textContent = '';
            apellidosError.style.display = 'none';
        }

        var genero = document.getElementById('registrargenero').value;
        var generoError = document.getElementById('generoError');
        if (genero === "") {
            generoError.textContent = 'Por favor, selecciona un género.';
            generoError.style.display = 'block';
            isValid = false;
        } else {
            generoError.textContent = '';
            generoError.style.display = 'none';
        }

        var privilegio = document.getElementById('registrarprivilegio').value;
        var privilegioError = document.getElementById('privilegioError');
        if (privilegio === "") {
            privilegioError.textContent = 'Por favor, selecciona un privilegio.';
            privilegioError.style.display = 'block';
            isValid = false;
        } else {
            privilegioError.textContent = '';
            privilegioError.style.display = 'none';
        }

        var usuario = document.getElementById('registrarusuario').value;
        var usuarioError = document.getElementById('usuarioError');
        var expresionus = /^[A-Za-zÁÉÍÓÚÜÑáéíóúüñ][A-Za-zÁÉÍÓÚÜÑáéíóúüñ0-9]{2,14}$/;

         if (!expresionus.test(usuario)) {
            usuarioError.textContent = 'Por favor, ingresa un usuario válido.';
            usuarioError.style.display = 'block';
            isValid = false;
        } else {
            usuarioError.textContent = '';
            usuarioError.style.display = 'none';
        }



        var contrasena = document.getElementById('registrarcontraseña').value;
        var confirmar = document.getElementById('registrarcontraseñaC').value;
        var contrasenaError = document.getElementById('contrasenaError');
        var confirmarError = document.getElementById('confirmarError');

        var expresionContrasena = /^(?=.*[A-Za-z])(?=.*\d)(?=.*[!@#$%^&*_])[A-Za-z\d!@#$%^&*_]{8,20}$/;

        if (!expresionContrasena.test(contrasena)) {
            contrasenaError.textContent = 'La contraseña debe tener al menos 8 caracteres, incluyendo letras, números y un carácter especial.';
            contrasenaError.style.display = 'block';
            isValid = false;
        } else {
        contrasenaError.textContent = '';
        contrasenaError.style.display = 'none';
        }

        if (contrasena !== confirmar) {
            confirmarError.textContent = 'Las contraseñas no coinciden. Inténtalo de nuevo.';
            confirmarError.style.display = 'block';
            isValid = false;
        } else {
            confirmarError.textContent = '';
            confirmarError.style.display = 'none';
        }


        return isValid;
    
        
    }
</script>